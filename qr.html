<!DOCTYPE html>
<html lang="en" class="qr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <title>Sokkai QR Code</title>
    <link rel='stylesheet' href='/style.css' />
</head>

<body class="qr">
<h1>Scan me!</h1>
<canvas id="canvas"></canvas>
</body>

<script src="/qrcode.js"></script>

<script>
    $(document).ready(function () {
        let roomID = window.location.pathname.split('/');
        roomID = (roomID && roomID.length > 1) ? roomID[roomID.length - 1] : null;

        if (roomID) {
            let url = `${document.location.origin}/room/${roomID}`;
            let size = (screen.availHeight < screen.availWidth ? screen.availHeight : screen.availWidth)/1.5;
            QRCode.toCanvas(document.getElementById('canvas'), url, {width:size}, function (error) {
                if (error) console.error(error)
                console.log('success!');
            });
        } else {
            alert('Invalid request. Check the URL and try again.');
        }

    });
</script>

</html>